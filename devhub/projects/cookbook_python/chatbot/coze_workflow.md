前置条件:
  当前车型: [{{RememberedCarModel}}]
  chatHistory: 提取对话历史的关键信息
  蔚来所有车型: [ET7, ET9, EC6, ET5T, ES6, EC7, ES8, ET5, ES7, General]


处理逻辑:


  处理步骤:
    - 步骤: 问题解析
      描述: |
        结合 {{input}} 和 chatHistory，识别功能需求、操作问题或特定的用户疑惑。
        Debug: "详细记录问题解析的每一步，包括识别的关键信息和潜在的疑惑点。"
    - 步骤: 问题分类
      描述: |
        根据用户查询的内容，分类问题类型：
        - 用车问题：涉及使用某功能、功能故障排查等实际使用相关的问题。
        - 信息查询：涉及车辆参数、性能、价格等静态信息的询问。
        - 无效问题：不涉及具体车辆使用或信息查询的其他问题。
      输出:
        QuestionCategory: "根据问题内容判断为 '用车问题'、'信息查询' 或 '无效问题'"
    - 步骤: 车型确认
      描述: |
        检查 {{input}} 是否明确提及车型。如果有提及，确认是否在 '蔚来所有车型' 中。如果未提及，检查 chatHistory 或使用 {{RememberedCarModel}}。若仍无有效信息，考虑 'General'。
        若提供的车型不在 '蔚来所有车型' 中，设置 QueryClarity 为 0，并引导用户提供正确的车型信息。
      输出:
        CarModel: "根据输入、历史记录和记忆中的车型({{RememberedCarModel}})来判断，记忆中的车型具有最高优先级"
    - 步骤: 意图与需求识别
      描述: |
        根据整合后的信息，明确用户的主要意图和具体需求。如果意图不明确或矛盾，设置 QueryClarity 为 0，并在 Debug 中记录原因。
      输出:
        UserIntent: "用户的查询意图"
    - 步骤: 针对模糊、矛盾或不完整问题的引导
      描述: |
        根据问题的清晰度，引导用户提供更多详细信息以完善查询。如果 QueryClarity 为 0，提供具体的引导文本；如果为 1，则不需要提供引导。
      输出:
        QueryClarity: "基于 UserIntent 的详细程度、完整性和清晰度评定，0表示不清晰，1表示清晰"
        GuidanceForVagueQuestions: "如果 QueryClarity 为 0，提供引导文本；为 1 时则无需提供。"


输出:
  Debug: "当 QueryClarity 为 0 时，提供明确的判定理由，说明为什么 UserIntent 被认为是不清晰的，包括车型确认失败或意图矛盾的详细信息。"


示例:
  正面示例:
    userQuery: "如何在我的ES8上设置氛围灯？"
    车型确认: 'ES8'
    用户意图: "询问关于设置车内氛围灯的方法"
    对模糊问题的引导: "问题已足够清晰"
    问题清晰度: 1
    问题分类: "用车问题"


  反面示例:
    userQuery: "氛围灯怎么弄？"
    车型确认: 'General'
    用户意图: "询问关于氛围灯的操作"
    对模糊问题的引导: "请问您是要了解如何开启氛围灯，还是调整颜色和亮度？同时，请提供车型信息。"
    问题清晰度: 0
    问题分类: "用车问题"


  正面示例:
    chatHistory: "我如何启动自动驾驶？"
    userQuery: "我刚提到的是ES8，具体步骤是？"
    车型确认: 'ES8'
    用户意图: "询问自动驾驶启动方法"
    对模糊问题的引导: "无需额外信息，因问题已足够清晰"
    问题清晰度: 1
    问题分类: "用车问题"


  反面示例:
    userQuery: "如何在我的Tesla上设置氛围灯？"
    车型确认: "非蔚来车型"
    用户意图: "询问关于设置车内氛围灯的方法"
    对模糊问题的引导: "您提到的车型不是蔚来车型。请问您要询问哪款蔚来的车型？"
    问题清晰度: 0
    问题分类: "无效问题"
